# PokÃ©mon Card Collection Manager

A comprehensive Python toolkit for managing, organizing, and valuating your PokÃ©mon Trading Card collection. This project automates the entire workflow from card identification to market valuation and sales preparation.

## ğŸ¯ Project Overview

This suite of tools helps collectors and sellers streamline their PokÃ©mon card management through:

- **Automated card identification** using computer vision
- **Multi-language support** (EN, FR, DE, JA)
- **Market price tracking** via CardMarket scraping
- **Inventory management** with CSV export for TCG platforms
- **Learning system** that improves accuracy over time

---

## ğŸ“‹ Table of Contents

1. [Prerequisites](#prerequisites)
2. [Installation](#installation)
3. [Module 1: Card Database Setup](#module-1-card-database-setup)
4. [Module 2: Card Renamer & Identifier](#module-2-card-renamer--identifier)
5. [Module 3: Price Scraper](#module-3-price-scraper)
6. [Module 4: Inventory CSV Generator](#module-4-inventory-csv-generator)
7. [Module 5: eBay Listing Creator (WIP)](#module-5-ebay-listing-creator-wip)
8. [Folder Structure](#folder-structure)
9. [Troubleshooting](#troubleshooting)

---

## âš™ï¸ Prerequisites

### Required Software
- **Python 3.8+**
- **pip** (Python package manager)

### Python Dependencies

```bash
pip install opencv-python numpy pillow undetected-chromedriver selenium beautifulsoup4 aiohttp cloudinary python-dotenv
```

### Required Data
- PokÃ©mon card images (scanned/photographed)
- TCGdex API access (free, no key required)
- CardMarket account (for price scraping)
- Cloudinary account (for eBay module - optional)

---

## ğŸš€ Installation

1. **Clone or download this repository**

2. **Set up folder structure:**

```
YourProject/
â”œâ”€â”€ PokemonCardLists/
â”‚   â”œâ”€â”€ Card_Sets/          # Generated by Module 1
â”‚   â”œâ”€â”€ all_sets_full.json  # Generated by Module 1
â”‚   â””â”€â”€ pokedex.csv         # For old sets (pre-2002)
â”œâ”€â”€ YourCardCollection/     # Your card images organized by set
â”‚   â””â”€â”€ SetName_SETID/
â”‚       â””â”€â”€ raw/
â”‚           â”œâ”€â”€ EN/
â”‚           â”œâ”€â”€ FR/
â”‚           â””â”€â”€ ...
â””â”€â”€ Scripts/                # Python scripts
```

---

## ğŸ“¦ Module 1: Card Database Setup

### Purpose
Downloads official card data and images from TCGdex API to create a reference database for card identification.

### Scripts
- `pokemon_API_CardListCsvGenerator.py` - Downloads card data (names, numbers, rarities)
- `pokemon_API_CardIMGDownloader.py` - Downloads high-res card images

### Usage

#### Step 1: Generate Card Lists

```bash
python pokemon_API_CardListCsvGenerator.py
```

**What it does:**
- Fetches card data from TCGdex API
- Creates CSV files for each language
- Organizes data by set

**Output:**

```
PokemonCardLists/Card_Sets/
â””â”€â”€ SetName_SETID/
    â”œâ”€â”€ CardList_SETID_en.csv
    â”œâ”€â”€ CardList_SETID_fr.csv
    â”œâ”€â”€ CardList_SETID_de.csv
    â””â”€â”€ CardList_SETID_ja.csv
```

#### Step 2: Download Card Images

```bash
python pokemon_API_CardIMGDownloader.py
```

**Interactive menu:**
1. Select specific set by number
2. Search by set name/code
3. Download ALL sets

**Output:**

```
PokemonCardLists/Card_Sets/
â””â”€â”€ SetName_SETID/
    â””â”€â”€ IMG/
        â”œâ”€â”€ setid-001_1.jpg
        â”œâ”€â”€ setid-002_2.jpg
        â””â”€â”€ ...
```

### Tips
- Download images for sets you own first to save bandwidth
- High-res images (~1600x1600px) are used for accurate matching
- The script auto-detects set series (e.g., `sv`, `swsh`, `xy`)

---

## ğŸ·ï¸ Module 2: Card Renamer & Identifier

### Purpose
The core module that identifies cards from photos, renames them systematically, and learns from corrections.

### Scripts
- `Main_Renamer_learning.py` - Main processing engine
- `Manual_corrector.py` - Fix misidentified cards
- `cards_utils.py` - Shared utilities and learning system

### Features
- **Computer vision matching** using ORB feature detection
- **Smart learning system** - remembers correct matches
- **Auto-cropping** - removes black borders
- **Multi-threaded** - processes multiple languages simultaneously
- **CSV export** - generates inventory files

### Folder Structure Required

```
YourCardCollection/
â””â”€â”€ SetName_SETID/
    â””â”€â”€ raw/
        â”œâ”€â”€ EN/
        â”‚   â”œâ”€â”€ card_front_001.jpg
        â”‚   â”œâ”€â”€ card_back_001.jpg
        â”‚   â”œâ”€â”€ card_front_002.jpg
        â”‚   â””â”€â”€ card_back_002.jpg
        â”œâ”€â”€ FR/
        â””â”€â”€ ...
```

**Important:** Cards must be in pairs (front + back) with sequential numbering. ( image 1 Front , Image 2 Back , Image 3 Front ect...)

### Usage

#### Processing Cards

```bash
python Main_Renamer_learning.py
```

**Select mode:**
1. **Full Process** - Identify and rename cards
2. **Collection List Only** - Rebuild collection_list.txt from existing files

**Processing options:**
- Single set or batch multiple sets
- Select specific languages or ALL
- Clear existing data or append

**What happens:**
1. Script loads reference images from Module 1
2. Crops card photos to remove borders
3. Matches against reference database using computer vision
4. Shows top 3 matches with confidence scores
5. Displays comparison window for verification
6. You confirm or manually enter correct card
7. Saves renamed files and updates learning database

**User interaction example:**

```
=============================================================
[FR] MATCH REQUEST
=============================================================
  Top matches:
    1. Meganium (#154) - 0.210
    2. Typhlosion (#157) - 0.098
    3. Feraligatr (#155) - 0.087

  âœ“ Best: Meganium (0.210)

  ğŸ‘€ CHECK THE COMPARISON WINDOW!
  [FR] Accept 'Meganium'? (y/n): 
```

**Output:**

```
SetName_SETID/
â”œâ”€â”€ Renamed_Cropped/
â”‚   â”œâ”€â”€ EN/
â”‚   â”‚   â”œâ”€â”€ Meganium_154_NEO1_EN_FRONT.jpg
â”‚   â”‚   â”œâ”€â”€ Meganium_154_NEO1_EN_BACK.jpg
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ FR/
â”œâ”€â”€ SETID_inventory.csv
â””â”€â”€ learning_db_SETID.pkl
```

#### Correcting Mistakes

```bash
python Manual_corrector.py
```

**Usage:**
1. Enter path to set folder
2. Select language
3. Enter filename (or part of it) to correct
4. Search for correct card by number or name
5. Confirm correction

**The script will:**
- Rename both FRONT and BACK files
- Update the learning database
- Remove old incorrect learning entry

### Learning System

The learning system (`LearningSystem` class) uses perceptual hashing to remember cards:

- **Auto-match** - Cards seen before are instantly recognized (>85% confidence)
- **Blacklist** - Rejected suggestions won't appear again
- **Statistics** - Tracks auto-match rate and improvements

**Learning database files:** `learning_db_SETID.pkl`

---

## ğŸ’° Module 3: Price Scraper

### Purpose
Scrapes current market prices from CardMarket for your entire collection, tracking price history over time.

### Script
- `CardMarketScrapper.py`

### Features
- **Multi-threaded scraping** (configurable threads dont use more than 6)
- **Multiple search strategies** with caching
- **Rate limiting** to avoid detection
- **Price history tracking** (30-day average)
- **Smart strategy learning** per set
- **Daily incremental updates**

### Usage

```bash
python CardMarketScrapper.py
```

**Input:**

```
Base folder path (D:\05-Pokemon\01-Collection or D:\05-Pokemon\02-vente): 
```

**What it does:**
1. Scans all `Renamed_Cropped` folders
2. For each card, tries multiple strategies:
   - Saved URL (from previous scrapes)
   - Direct URL construction
   - PTCGO code matching
   - English name fallback
   - Search by card number
   - V2 variants
3. Extracts prices (30-day average, trending, low/high)
4. Saves results to `cardmarket_all_prices.json`

**Strategy caching:**
The scraper remembers which strategy worked for each set, making future scrapes faster.

**Output structure:**

```json
{
  "Collection_Total_Value": 1234.56,
  "collection_history": [
    {"date": "2025-12-23", "total_value": 1234.56}
  ],
  "last_updated": "2025-12-23 14:30:00",
  "set_strategies": {
    "SetName_SETID": {
      "direct_url": 45,
      "ptcgo_code": 12,
      "search": 3
    }
  },
  "results": [
    {
      "card_info": {
        "set_folder": "Neo-Genesis_NEO1",
        "card_name": "Meganium",
        "card_number": "154",
        "language": "FR"
      },
      "url": "https://www.cardmarket.com/...",
      "prices": {
        "Prix moyen 30 jours": "2,50",
        "Prix Ã  partir de": "0,02"
      },
      "price_history": [
        {"date": "2025-12-01", "price": 2.45},
        {"date": "2025-12-23", "price": 2.50}
      ],
      "success": true,
      "strategy": "direct_url"
    }
  ]
}
```

### Configuration

**Adjust thread count:**

```python
num_threads = 4  #(4 Is max i used , splitting the screen in 4 as CloudFlare ask for user Input from time to time)
```

**Language support:**
Currently scrapes: EN, FR, DE (configurable via `LANGUAGE_MAP`)

### Tips
- Run daily to track price trends
- First run takes longer (no cached strategies)
- Subsequent runs are much faster
- Skips cards already scraped today
- Use 1-2 threads to be more stealthy

---

## ğŸ“Š Module 4: Inventory CSV Generator

### Purpose
Generates standardized CSV files compatible with TCG collection management tools (TCGPlayer, Cardmarket, etc.).

### Script
- `generate_CSV.py`

### Usage

```bash
python generate_CSV.py
```

**Input:**

```
Base folder path (D:\05-Pokemon\01-Collection or D:\05-Pokemon\02-vente): 
```

**What it does:**
1. Scans all `Renamed_Cropped` folders
2. Extracts card information from filenames
3. Loads English names from CardList CSVs
4. Matches set codes using `all_sets_full.json`
5. Generates inventory CSV
6. Import CSV in TCG PowerTool , linked to your CardMarket to list all card in one go

**Output:** `pokemon_cards_inventory.csv`

```csv
Card Name,Collector Number,Set Code,Quantity,Language,Foil,Condition,Comment
Meganium,154,neo1,1,FR,no,NM,New seller, DM for more pictures
Typhlosion,157,neo1,1,FR,no,NM,New seller, DM for more pictures
```

### Customization

Edit default values in the script:

```python
csv_data.append({
    'Quantity': 1,
    'Foil': 'no',
    'Condition': 'NM',
    'Comment': 'New seller, DM for more pictures'
})
```

### CSV Fields
- **Card Name** - English name (from CardList)
- **Collector Number** - Card number in set
- **Set Code** - PTCGO set code
- **Quantity** - Number of copies
- **Language** - Card language
- **Foil** - Holo/non-holo
- **Condition** - NM, LP, MP, HP, DMG
- **Comment** - Additional notes

---

## ğŸ›’ Module 5: eBay Listing Creator (WIP)

### âš ï¸ Status: Work in Progress - NOT FUNCTIONAL

### Known Issues

1. **eBay API Limitations:**
   - Free API doesn't allow actual listing creation
   - Production API requires eBay business account
   - Testing limited to XML validation only

2. **Image Upload Problems:**
   - eBay requires HTTPS URLs for images
   - Attempted Cloudinary integration has authentication issues
   - eBay's own image hosting (EPS) requires complex OAuth flow

### Scripts
- `ebay_listing_creator.py` - Main creator (non-functional)
- `ebay_title.py` - Title generator (works)

### What Works

#### Title Generator

```bash
python ebay_title.py
```

Generates eBay-compliant titles (80 char max):

```
Carte Pokemon - Meganium - 154 - NM - Neo Genesis - Fr
```

### What Doesn't Work
- Actual listing creation
- Image upload to eBay
- Cloudinary integration
- Production mode posting

### Required Setup (for future work)

```bash
# .env file
EBAY_APP_ID=your_app_id
EBAY_DEV_ID=your_dev_id
EBAY_CERT_ID=your_cert_id
EBAY_USER_TOKEN=your_user_token

CLOUDINARY_CLOUD_NAME=your_cloud
CLOUDINARY_API_KEY=your_key
CLOUDINARY_API_SECRET=your_secret
```

### Future Work Needed
1. Implement eBay's OAuth 2.0 flow
2. Upgrade to eBay business account
3. Fix image upload to Cloudinary or use eBay EPS
4. Test with real API credentials
5. Add bulk listing support
6. Implement listing management (edit/delete)

---

## ğŸ“ Folder Structure

### Complete Project Layout

```
Project/
â”œâ”€â”€ PokemonCardLists/           # Card reference database
â”‚   â”œâ”€â”€ Card_Sets/              # Per-set folders
â”‚   â”‚   â””â”€â”€ SetName_SETID/
â”‚   â”‚       â”œâ”€â”€ CardList_SETID_en.csv
â”‚   â”‚       â”œâ”€â”€ CardList_SETID_fr.csv
â”‚   â”‚       â””â”€â”€ IMG/
â”‚   â”‚           â””â”€â”€ setid-001_1.jpg
â”‚   â”œâ”€â”€ all_sets_full.json      # Set metadata
â”‚   â””â”€â”€ pokedex.csv             # For old sets
â”‚
â”œâ”€â”€ YourCardCollection/         # Your cards (organized by set)
â”‚   â””â”€â”€ SetName_SETID/
â”‚       â”œâ”€â”€ raw/                # Original photos (input)
â”‚       â”‚   â”œâ”€â”€ EN/
â”‚       â”‚   â”‚   â”œâ”€â”€ img001.jpg  # Front
â”‚       â”‚   â”‚   â”œâ”€â”€ img002.jpg  # Back
â”‚       â”‚   â”‚   â””â”€â”€ processed/  # Moved after processing
â”‚       â”‚   â”œâ”€â”€ FR/
â”‚       â”‚   â””â”€â”€ ...
â”‚       â”œâ”€â”€ Renamed_Cropped/    # Processed cards (output)
â”‚       â”‚   â”œâ”€â”€ EN/
â”‚       â”‚   â”‚   â”œâ”€â”€ CardName_001_SETID_EN_FRONT.jpg
â”‚       â”‚   â”‚   â””â”€â”€ CardName_001_SETID_EN_BACK.jpg
â”‚       â”‚   â””â”€â”€ FR/
â”‚       â”œâ”€â”€ SETID_inventory.csv # Set inventory
â”‚       â””â”€â”€ learning_db_SETID.pkl # Learning data
â”‚
â”œâ”€â”€ PokemonTCGAPI/
â”‚   â””â”€â”€ collection_list.txt     # Master collection list
â”‚
â”œâ”€â”€ TcgPowerTool/
â”‚   â””â”€â”€ pokemon_cards_inventory.csv  # Full inventory
â”‚
â”œâ”€â”€ Scripts/                    # Python scripts
â”‚   â”œâ”€â”€ cards_utils.py
â”‚   â”œâ”€â”€ Main_Renamer_learning.py
â”‚   â”œâ”€â”€ Manual_corrector.py
â”‚   â”œâ”€â”€ CardMarketScrapper.py
â”‚   â”œâ”€â”€ generate_CSV.py
â”‚   â”œâ”€â”€ pokemon_API_CardListCsvGenerator.py
â”‚   â”œâ”€â”€ pokemon_API_CardIMGDownloader.py
â”‚   â”œâ”€â”€ ebay_listing_creator.py
â”‚   â””â”€â”€ ebay_title.py
â”‚
â”œâ”€â”€ cardmarket_all_prices.json  # Price database
â”œâ”€â”€ set_strategy_cache.json     # Scraper strategy cache
â””â”€â”€ requirements.txt            # Python dependencies
```

---

## ğŸ”§ Troubleshooting

### Card Identification Issues

**Problem:** Card not matching correctly

- **Solution 1:** Use `Manual_corrector.py` to fix and teach the system
- **Solution 2:** Ensure reference images downloaded (Module 1)
- **Solution 3:** Check card photos are clear and well-lit

**Problem:** "No reference images found"

- **Solution:** Run Module 1 for that set
- Check set code matches between collection and database folders

**Problem:** Low confidence matches (<0.25)

- **Cause:** Poor photo quality, glare, or damaged cards
- **Solution:** Retake photos or manually verify matches

### CSV Generation Issues

**Problem:** Set code showing as "UNKNOWN"

- **Solution:** Ensure folder named correctly: `SetName_SETID`
- Update `all_sets_full.json` with correct set mapping

**Problem:** Wrong English names

- **Solution:** Re-run Module 1 to download latest card data
- Check CardList CSV files exist and are populated

### General Issues

**Problem:** Import errors

```bash
ModuleNotFoundError: No module named 'cv2'
```

**Solution:**

```bash
pip install opencv-python
```

**Problem:** Unicode errors (Windows)

**Solution:** Ensure UTF-8 encoding:

```python
if sys.platform == 'win32':
    sys.stdout.reconfigure(encoding='utf-8')
```

**Problem:** Out of memory (large collections)

**Solution:** Process sets one at a time instead of batch mode

---

## ğŸ“ˆ Performance Tips

### For Large Collections (1000+ cards)

1. **Module 2 (Renaming):**
   - Process one language at a time
   - Use learning system to speed up subsequent sets
   - Batch process similar sets together

2. **Module 3 (Scraping):**
   - Run with human supervision as CloudFlare ask for input
   - Check `set_strategy_cache.json` to see which sets need work

---

## ğŸ“ Note

This is a personal project to learn and practice. I'm not sure it's really time efficient, but i wanted to know my collection value, 
and save all my card picture ( Just in case ).
The collection_list.txt can be used in PriceCharting to get almost the same price as PriceMarket without the scraping Method. 
This project was done mainly on Wizard Card from the 2000. It might struggle with some sets for the cropping section. Have fun 

---

## ğŸ“ License

This project is for personal use. PokÃ©mon and related trademarks are property of Nintendo/Game Freak/Creatures Inc.

---

## ğŸ™ Credits

- **TCGdex API** - Card data and images ( Free and perfect )
- **CardMarket** - Price data ( Thank for gateKeeping the API )

---

## ğŸ“® Support

For questions or issues:
1. Check this README thoroughly
2. Check script comments for detailed explanations
3. Test with a small set first before processing entire collection

**Happy collecting! ğŸ´**